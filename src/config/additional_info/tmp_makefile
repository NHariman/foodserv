COMPILE = c++

FLAGS = -Wall -Werror -Wextra -std=c++11

MAIN = nginx_main.cpp

REQUEST =	src/request/request_utils.cpp \
			src/request/chunked_parser.cpp \
			src/request/header_field_parser.cpp \
			src/request/header_field_validator.cpp \
			src/request/request_line_parser.cpp \
			src/request/request.cpp \
			src/request/request_parser.cpp \
			src/request/request_target_parser.cpp \
			src/request/uri_host_parser.cpp \
			src/request/uri.cpp 

CONFIG = src/config/config_interface.cpp \
		src/config/setup.cpp \
		src/config/server_name.cpp \
		src/config/server_context.cpp \
		src/config/listen.cpp \
		src/config/location_context.cpp \
		src/config/nginx_config.cpp \
		src/config/config_utils.cpp \
		src/config/directive_validation/client_max_body_size.cpp \
		src/config/directive_validation/allowed_methods.cpp \
		src/config/directive_validation/autoindex.cpp \
		src/config/directive_validation/error_page.cpp \
		src/config/directive_validation/fastcgi_pass.cpp \
		src/config/directive_validation/index.cpp \
		src/config/directive_validation/location_uri.cpp \
		src/config/directive_validation/return_dir.cpp \
		src/config/directive_validation/root.cpp

OFILES = $(CONFIG:.cpp=.o) $(MAIN:.cpp=.o) $(REQUEST:.cpp=.o)

NAME = webserv

all: $(NAME)

$(NAME): $(OFILES) 
	@$(COMPILE) $(OFILES) -o $@ 

%.o: %.cpp %.hpp src/config/directive_validation/directive_validation.hpp
	$(COMPILE) $(FLAGS) -c $< -o $@

clean:
	@$(RM) $(OFILES)
	@rm -rf obj/

fclean: clean
	@$(RM) $(NAME) 

re: fclean all

test: re
	./$(NAME)